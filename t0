{"name":"w3_s6_u2_assign_stagmass_base","author":"new_user","flowchart":{"id":"acf8491d-2679-bb98-efec-9d6f9be679c9","name":"Urban density study","description":"","language":"js","meta":{"selected_nodes":[0]},"nodes":[{"name":"Start","id":"node_nbrvk1v9nf","position":{"x":5340,"y":5000},"enabled":true,"type":"start","procedure":[{"type":13,"ID":"main_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":10,"ID":"parameters_blank","meta":{"description":"","inputMode":5,"module":"ParamBlank","name":"Constant"},"argCount":0,"args":[],"print":false,"enabled":false,"terminate":false},{"type":10,"ID":"prod-0y0a575ol95","enabled":true,"print":false,"argCount":2,"meta":{"module":"Input","name":"Constant","inputMode":1,"description":"Random seed for generating layouts"},"args":[{"name":"const_name","value":"RAND_SEED","jsValue":"RAND_SEED_"},{"name":"__input__","value":0.5419,"step":"0.0001","min":"0","max":"1"}],"selectGeom":false},{"type":10,"ID":"prod-7yvlw7vgdd8","enabled":true,"print":false,"argCount":2,"meta":{"module":"Input","name":"Constant","inputMode":1,"description":"Number of buildings"},"args":[{"name":"const_name","value":"NUM_BLDGS","jsValue":"NUM_BLDGS_"},{"name":"__input__","value":16,"step":"1","min":"8","max":"50"}],"selectGeom":false},{"type":10,"ID":"prod-jps6ndn5wrg","enabled":true,"print":false,"argCount":2,"meta":{"module":"Input","name":"Constant","inputMode":1,"description":"Target Gross Floor Area Ratio"},"args":[{"name":"const_name","value":"GFAR","jsValue":"GFAR_"},{"name":"__input__","value":"4","step":"1","min":"2","max":"20"}],"selectGeom":false},{"type":10,"ID":"prod-njfyrg1j4ce","enabled":true,"print":false,"argCount":2,"meta":{"module":"Input","name":"Constant","inputMode":1,"description":"Street view angle"},"args":[{"name":"const_name","value":"VIEW_ANGLE","jsValue":"VIEW_ANGLE_"},{"name":"__input__","value":"60","step":"1","min":"10","max":"90"}],"selectGeom":false},{"type":10,"ID":"prod-m4kvzy731qq","enabled":true,"print":false,"argCount":2,"meta":{"module":"Input","name":"Constant","inputMode":1,"description":"Pavement width"},"args":[{"name":"const_name","value":"PAV_WIDTH","jsValue":"PAV_WIDTH_"},{"name":"__input__","value":5,"step":"1","min":"0","max":"12"}],"selectGeom":false},{"type":10,"ID":"prod-j10rcklj0d","enabled":true,"print":false,"argCount":2,"meta":{"module":"Input","name":"Constant","inputMode":1,"description":"Street width"},"args":[{"name":"const_name","value":"STREET_WIDTH","jsValue":"STREET_WIDTH_"},{"name":"__input__","value":"7","step":"1","min":"5","max":"30"}],"selectGeom":false},{"type":10,"ID":"prod-cze1n40oveq","enabled":true,"print":false,"argCount":2,"meta":{"module":"Input","name":"Constant","inputMode":1,"description":"Setback width"},"args":[{"name":"const_name","value":"SETBACK","jsValue":"SETBACK_"},{"name":"__input__","value":"8","step":"1","min":"5","max":"30"}],"selectGeom":false},{"type":10,"ID":"prod-b3s2srvqvbi","enabled":true,"print":false,"argCount":2,"meta":{"module":"Input","name":"Constant","inputMode":6,"description":"Show view angle polygons"},"args":[{"name":"const_name","value":"SHOW_VIEW","jsValue":"SHOW_VIEW_"},{"name":"__input__","value":"\"show\"","max":"[\"show\", \"don't show\"]","min":["\"show\"","\"don't show\""]}]}],"localFunc":[{"type":13,"ID":"local_func_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false}],"state":{"procedure":[],"show_code":false,"show_func":false,"hasExecuted":true},"input":{"name":"input","type":0,"edges":[],"meta":{"mode":0,"opts":{}},"parentNode":"~flowchart~nodes~0"},"output":{"name":"output","type":1,"edges":[{"source":"~flowchart~nodes~0~output","target":{"name":"input","type":0,"edges":["~flowchart~nodes~0~output~edges~0"],"meta":{"mode":0,"opts":{}},"parentNode":{"name":"Plots","id":"node_by4660b2v1r","position":{"x":5340,"y":5120},"enabled":true,"type":"","procedure":[{"type":13,"ID":"","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":14,"ID":"prod-vtjowgf8fai","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Constants"}]},{"type":0,"ID":"prod-55vjgrwh878","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"road_width","jsValue":"road_width_"},{"name":"value","value":"20","usedVars":[],"jsValue":"20"}],"variable":["road_width"],"selectGeom":false},{"type":0,"ID":"prod-uhfzvzvho48","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"block_size","jsValue":"block_size_"},{"name":"value","value":"300","usedVars":[],"jsValue":"300"}],"variable":["block_size"],"selectGeom":false},{"type":14,"ID":"prod-wvg14d775z","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Create one blocks"}]},{"type":8,"ID":"prod-loeob180nn","enabled":true,"print":false,"meta":{"module":"pattern","name":"Rectangle"},"argCount":4,"args":[{"name":"var_name","value":"block_posis","jsValue":"block_posis_"},{"name":"__model__"},{"name":"origin","value":"XY","usedVars":[],"jsValue":"JSON.parse(JSON.stringify(XY))"},{"name":"size","value":"block_size","usedVars":["block_size"],"jsValue":"block_size_"}],"variable":["block_posis"],"selectGeom":false},{"type":8,"ID":"prod-6c9rkhp1x75","enabled":true,"print":false,"meta":{"module":"make","name":"Polygon"},"argCount":3,"args":[{"name":"var_name","value":"block","jsValue":"block_"},{"name":"__model__"},{"name":"entities","usedVars":["block_posis"],"value":"block_posis","jsValue":"block_posis_"}],"variable":["block"],"selectGeom":false},{"type":14,"ID":"prod-vb3nk9tm79e","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Subdiv the block into plot polygons"}]},{"type":18,"ID":"prod-l9dpipfcdjc","enabled":true,"print":false,"argCount":3,"meta":{"module":"localFunc","name":"voronoiPosisGrid","otherInfo":{}},"args":[{"name":"var_name","value":"posis","jsValue":"posis_"},{"name":"rect","value":"block","usedVars":["block"],"jsValue":"block_"},{"name":"seed","value":"RAND_SEED","jsValue":"RAND_SEED_","usedVars":["RAND_SEED"]}],"variable":["posis"],"selectGeom":false},{"type":14,"ID":"prod-h1q2zakb8o","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Voronoi subdivision"}],"selectGeom":false},{"type":8,"ID":"prod-g9ql43gmgof","enabled":true,"print":false,"meta":{"module":"poly2d","name":"Voronoi"},"argCount":4,"args":[{"name":"var_name","value":"plots","jsValue":"plots_"},{"name":"__model__"},{"name":"pgons","value":"block","usedVars":["block"],"jsValue":"block_"},{"name":"entities","value":"posis","usedVars":["posis"],"jsValue":"posis_"}],"variable":["plots"],"selectGeom":false},{"type":14,"ID":"prod-46tmvpg0057","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Inset to create streets"}],"selectGeom":false},{"type":8,"ID":"prod-8tukgzw5uww","enabled":true,"print":false,"meta":{"module":"poly2d","name":"OffsetMitre"},"argCount":6,"args":[{"name":"var_name","value":"plots","jsValue":"plots_"},{"name":"__model__"},{"name":"entities","value":"plots","usedVars":["plots"],"jsValue":"plots_"},{"name":"dist","value":"-STREET_WIDTH / 2","usedVars":["STREET_WIDTH"],"jsValue":"-STREET_WIDTH_ / 2"},{"name":"limit","value":"road_width","usedVars":["road_width"],"jsValue":"road_width_"},{"name":"end_type","value":"'square_end'","jsValue":"'square_end'","usedVars":[]}],"variable":["plots"],"selectGeom":false},{"type":14,"ID":"prod-kqejhrb2h4","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Create a collection for each block"}],"selectGeom":false},{"type":8,"ID":"prod-td9vdpl406d","enabled":true,"print":false,"meta":{"module":"collection","name":"Create"},"argCount":4,"args":[{"name":"var_name","value":"coll","jsValue":"coll_"},{"name":"__model__"},{"name":"entities","value":"plots","usedVars":["plots"],"jsValue":"plots_"},{"name":"name","value":"\"block\"","usedVars":[],"jsValue":"\"block\""}],"variable":["coll"],"selectGeom":false},{"type":8,"ID":"prod-futntvbwwb","enabled":true,"print":false,"meta":{"module":"calc","name":"Area"},"argCount":3,"args":[{"name":"var_name","value":"area","jsValue":"area_"},{"name":"__model__"},{"name":"entities","value":"block","usedVars":["block"],"jsValue":"block_"}],"variable":["area"],"selectGeom":false},{"type":14,"ID":"prod-7ds1m21ativ","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Add attributes"}],"selectGeom":false},{"type":0,"ID":"prod-clsx5rdeh3i","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"plots@type","jsValue":"plots_@type","usedVars":["plots"]},{"name":"value","value":"\"plot\"","usedVars":[],"jsValue":"\"plot\""}],"variable":null,"selectGeom":false},{"type":0,"ID":"prod-hodeezdg6bq","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"coll@req_floor_area","jsValue":"coll_@req_floor_area","usedVars":["coll"]},{"name":"value","value":"area * GFAR","usedVars":["GFAR","area"],"jsValue":"area_ * GFAR_"}],"variable":null,"selectGeom":false},{"type":0,"ID":"prod-q02ytjud55q","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"coll@block_area","jsValue":"coll_@block_area","usedVars":["coll"]},{"name":"value","value":"area","usedVars":["area"],"jsValue":"area_"}],"variable":null,"selectGeom":false},{"type":4,"ID":"prod-cfa5gg0z9nt","enabled":true,"print":false,"argCount":2,"args":[{"name":"item","value":"i","jsValue":"i_"},{"name":"list","value":"range(len(plots))","usedVars":["plots"],"jsValue":"range(__debug__, len(__debug__, plots_))"}],"children":[{"type":13,"ID":"prod-6dcd8l1z6cm","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~procedure~20","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~procedure~20","ID":"prod-7ta6qid9sjc","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"plots[i]@bldg_id","jsValue":"plots_[pythonList(i_, plots_.length)]@bldg_id","usedVars":["plots","i"]},{"name":"value","value":"i","usedVars":["i"],"jsValue":"i_"}],"variable":null,"selectGeom":false}],"variable":["i"],"selectGeom":false},{"type":14,"ID":"prod-ul9xvpeoa8a","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Clean up"}]},{"type":8,"ID":"prod-gn85gst1krj","enabled":true,"print":false,"meta":{"module":"edit","name":"Delete"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"#co","usedVars":[],"jsValue":"__modules__.query.Get(__params__.model, 'co', null)"},{"name":"method","value":"'keep_selected'","jsValue":"'keep_selected'","usedVars":[]}]}],"localFunc":[{"type":13,"ID":"local_func_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":16,"ID":"prod-b8ypuef2c78","enabled":true,"print":false,"argCount":3,"meta":{"module":"","name":"","otherInfo":{"prev_name":"voronoiPosisGrid","num_returns":1,"collapsed":false}},"args":[{"name":"func_name","value":"voronoiPosisGrid","jsValue":"voronoiPosisGrid_"},{"name":"arg_1","value":"rect","jsValue":"rect_","usedVars":["rect"]},{"name":"arg_2","value":"seed","jsValue":"seed_","usedVars":["seed"]}],"children":[{"type":13,"ID":"prod-b8ypuef2c78-blank","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~localFunc~1","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~localFunc~1","ID":"prod-gj36fkll4a","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Function creates a grid of positions and randomly selects a set number"}]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~localFunc~1","ID":"prod-wbguyuouip","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Function returns selected positions"}]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~localFunc~1","ID":"prod-h0sw28f6k6n","enabled":true,"print":false,"meta":{"module":"calc","name":"Centroid"},"argCount":4,"args":[{"name":"var_name","value":"cen","jsValue":"cen_"},{"name":"__model__"},{"name":"entities","value":"rect","usedVars":["rect"],"jsValue":"rect_"},{"name":"method","value":"'center_of_mass'","usedVars":[],"jsValue":"'center_of_mass'"}],"variable":["cen"],"selectGeom":false},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~localFunc~1","ID":"prod-0yr6v10ixwr9","enabled":true,"print":false,"meta":{"module":"pattern","name":"Grid"},"argCount":6,"args":[{"name":"var_name","value":"posis","jsValue":"posis_"},{"name":"__model__"},{"name":"origin","value":"cen","usedVars":["cen"],"jsValue":"cen_"},{"name":"size","value":"260","usedVars":[],"jsValue":"260"},{"name":"num_positions","value":"8","usedVars":[],"jsValue":"8"},{"name":"method","value":"'flat'","usedVars":[],"jsValue":"'flat'"}],"selectGeom":false,"variable":["posis"]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~localFunc~1","ID":"prod-p74mezbmrm","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"The random selection uses a seed that can be varied in the script parameters"}]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~localFunc~1","ID":"prod-imiy9qfvz7r","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"posis","jsValue":"posis_"},{"name":"value","value":"randPick(posis, NUM_BLDGS, seed)","usedVars":["NUM_BLDGS","posis","seed"],"jsValue":"randPick(__debug__, posis_, NUM_BLDGS_, seed_)"}],"variable":["posis"],"selectGeom":false},{"type":17,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~localFunc~1","ID":"prod-qxqk5f4wkz","enabled":true,"print":false,"argCount":1,"args":[{"name":"Value","value":"posis","usedVars":["posis"],"jsValue":"posis_"}],"selectGeom":false}],"variable":null}],"state":{"procedure":[],"show_code":true,"show_func":true,"hasExecuted":true},"hasError":false,"hasExecuted":true,"input":"~flowchart~nodes~0~output~edges~0~target","output":{"name":"output","type":1,"edges":[{"source":"~flowchart~nodes~0~output~edges~0~target~parentNode~output","target":{"name":"input","type":0,"edges":["~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0"],"meta":{"mode":0,"opts":{}},"parentNode":{"name":"Building Massing\n\\x7eEDIT~","id":"node_du78cl3mu0p","position":{"x":5340,"y":5240},"enabled":true,"type":"","procedure":[{"type":13,"ID":"main_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":0,"ID":"prod-5l5x6pszyw","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"coll","jsValue":"coll_"},{"name":"value","value":"#co[0]","usedVars":[],"jsValue":"__modules__.query.Get(__params__.model, 'co', null)[pythonList(0, __modules__.query.Get(__params__.model, 'co', null).length)]"}],"variable":["coll"]},{"type":14,"ID":"prod-vozv2bdvop","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Calc the view angle in radians"}]},{"type":0,"ID":"prod-sr4nvv45o","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"ang","jsValue":"ang_"},{"name":"value","value":"degToRad(90 - (VIEW_ANGLE / 2))","usedVars":["VIEW_ANGLE"],"jsValue":"degToRad(__debug__, 90 - (VIEW_ANGLE_ / 2))"}],"variable":["ang"],"selectGeom":false},{"type":14,"ID":"prod-qyxum3otjd","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Create a \"wedding cake\" massing"}]},{"type":14,"ID":"prod-t3bb1dpxscl","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Get the total required floor area for the whole block"}],"selectGeom":false},{"type":0,"ID":"prod-rvfyfs5ekg","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"req_floor_area","jsValue":"req_floor_area_"},{"name":"value","value":"coll@req_floor_area","usedVars":["coll"],"jsValue":"__modules__.attrib.Get(__params__.model, coll_, 'req_floor_area')"}],"variable":["req_floor_area"],"selectGeom":false},{"type":0,"ID":"prod-qoduyp03vvc","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"rem_area","jsValue":"rem_area_"},{"name":"value","value":"req_floor_area","usedVars":["req_floor_area"],"jsValue":"req_floor_area_"}],"variable":["rem_area"],"selectGeom":false},{"type":0,"ID":"prod-t5hv7wvceog","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"plots","jsValue":"plots_"},{"name":"value","value":"coll#pg","usedVars":["coll"],"jsValue":"__modules__.query.Get(__params__.model, 'pg', coll_)"}],"variable":["plots"],"selectGeom":false},{"type":14,"ID":"prod-iy5px6q3rx9","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Create polygons that align with the centre of the street"}],"selectGeom":false},{"type":8,"ID":"prod-tco3a6xhoec","enabled":true,"print":false,"meta":{"module":"make","name":"Copy"},"argCount":4,"args":[{"name":"var_name","value":"street_views","jsValue":"street_views_"},{"name":"__model__"},{"name":"entities","value":"plots","usedVars":["plots"],"jsValue":"plots_"},{"name":"vector","value":"null","usedVars":[],"jsValue":"null"}],"variable":["street_views"],"selectGeom":false},{"type":8,"ID":"prod-d5udu92ehdk","enabled":true,"print":false,"meta":{"module":"modify","name":"Offset"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"street_views","usedVars":["street_views"],"jsValue":"street_views_"},{"name":"dist","value":"STREET_WIDTH / 2","usedVars":["STREET_WIDTH"],"jsValue":"STREET_WIDTH_ / 2"}],"terminate":false,"selectGeom":false},{"type":0,"ID":"prod-im8y4mnh72d","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"bases","jsValue":"bases_"},{"name":"value","value":"street_views","usedVars":["street_views"],"jsValue":"street_views_"}],"variable":["bases"],"selectGeom":false},{"type":14,"ID":"prod-ruuzc1t40df","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"We need to keep adding floors until the required floor area has been reached"}],"selectGeom":false},{"type":14,"ID":"prod-uk3sz65y1sc","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"We have two nested loops"}],"selectGeom":false},{"type":14,"ID":"prod-5vtl9oblx8o","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"The outer loops over the layers "}],"selectGeom":false},{"type":14,"ID":"prod-zld3tejqoqn","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"The inner loops over the buildings"}],"selectGeom":false},{"type":14,"ID":"prod-lwrxu69apye","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"The maximum number of layers is hardcoded as 10"}],"selectGeom":false},{"type":4,"ID":"prod-fyt4p34zpol","enabled":true,"print":false,"argCount":2,"args":[{"name":"item","value":"i","jsValue":"i_"},{"name":"list","value":"range(10)","usedVars":[],"jsValue":"range(__debug__, 10)"}],"children":[{"type":13,"ID":"prod-hwvmggjvrop","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18","ID":"prod-t634rxy1jl","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"reached_limit","jsValue":"reached_limit_"},{"name":"value","value":"true","usedVars":[],"jsValue":"true"}],"variable":["reached_limit"],"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18","ID":"prod-2qzk0qzzna8","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"new_bases","jsValue":"new_bases_"},{"name":"value","value":"[]","usedVars":[],"jsValue":"[]"}],"variable":["new_bases"],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18","ID":"prod-or1ojx5sd0o","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Add the next layer to all the buildings"}],"selectGeom":false},{"type":4,"ID":"prod-woid4bmbg2j","enabled":true,"print":false,"argCount":2,"args":[{"name":"item","value":"base","jsValue":"base_"},{"name":"list","value":"bases","usedVars":["bases"],"jsValue":"bases_"}],"children":[{"type":13,"ID":"prod-mmy0mpkw37j","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4","ID":"prod-7jidwjqpnvi","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"floors","jsValue":"floors_"},{"name":"value","usedVars":["base"],"value":"[base]","jsValue":"[base_]"}],"variable":["floors"],"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4","ID":"prod-em8j7sqizue","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"width","jsValue":"width_"},{"name":"value","value":"null","usedVars":[],"jsValue":"null"}],"variable":["width"],"selectGeom":false},{"type":1,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4","ID":"prod-sr9mcwoq6ha","enabled":true,"print":false,"argCount":1,"args":[{"name":"condition","value":"i == 0","usedVars":["i"],"jsValue":"i_ == 0"}],"children":[{"type":13,"ID":"prod-a76zwaem3gj","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4~children~3","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4~children~3","ID":"prod-vr9rwwgt63","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"width","jsValue":"width_"},{"name":"value","usedVars":["STREET_WIDTH","PAV_WIDTH"],"value":"(STREET_WIDTH / 2) + PAV_WIDTH","jsValue":"(STREET_WIDTH_ / 2) + PAV_WIDTH_"}],"variable":["width"],"selectGeom":false}],"selectGeom":false},{"type":3,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4","ID":"prod-vmm9vi0jqc","enabled":true,"print":false,"argCount":0,"args":[],"children":[{"type":13,"ID":"prod-like5agall9","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4~children~4","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4~children~4","ID":"prod-wl3vay8hxwp","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"width","jsValue":"width_"},{"name":"value","usedVars":["SETBACK"],"value":"SETBACK","jsValue":"SETBACK_"}],"variable":["width"],"selectGeom":false}],"selectGeom":false},{"type":18,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4","ID":"prod-7ndfk4nkb3c","enabled":true,"print":false,"argCount":5,"meta":{"module":"localFunc","name":"createLayer"},"args":[{"name":"var_name","value":"new_area","jsValue":"new_area_"},{"name":"floors","value":"floors","usedVars":["floors"],"jsValue":"floors_"},{"name":"dist","value":"width","usedVars":["width"],"jsValue":"width_"},{"name":"ang","value":"ang","usedVars":["ang"],"jsValue":"ang_"},{"name":"rem_area","value":"rem_area","usedVars":["rem_area"],"jsValue":"rem_area_"}],"variable":["new_area"],"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4","ID":"prod-4qbejsrcnjm","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"rem_area","jsValue":"rem_area_"},{"name":"value","value":"rem_area - new_area","usedVars":["new_area","rem_area"],"jsValue":"rem_area_ - new_area_"}],"variable":["rem_area"],"selectGeom":false},{"type":1,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4","ID":"prod-m2j4e7tbocc","enabled":true,"print":false,"argCount":1,"args":[{"name":"condition","value":"new_area > 0","usedVars":["new_area"],"jsValue":"new_area_ > 0"}],"children":[{"type":13,"ID":"prod-drv1b3a10ui","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4~children~7","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4~children~7","ID":"prod-0zgcvp0hy4za","enabled":true,"print":false,"meta":{"module":"list","name":"Add"},"argCount":4,"args":[{"name":"__none__"},{"name":"list","value":"new_bases","usedVars":["new_bases"],"jsValue":"new_bases_"},{"name":"item","value":"floors[-1]","usedVars":["floors"],"jsValue":"floors_[pythonList(-1, floors_.length)]"},{"name":"method","value":"'to_end'","jsValue":"'to_end'","usedVars":[]}],"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~4~children~7","ID":"prod-lyp5s6t6beg","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"reached_limit","jsValue":"reached_limit_"},{"name":"value","value":"false","usedVars":[],"jsValue":"false"}],"variable":["reached_limit"],"selectGeom":false}],"selectGeom":false}],"variable":["base"],"selectGeom":false,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18"},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18","ID":"prod-g4eady5wwkd","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"bases","jsValue":"bases_"},{"name":"value","value":"new_bases","usedVars":["new_bases"],"jsValue":"new_bases_"}],"variable":["bases"],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18","ID":"prod-bux402qwp9a","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"If the 'reached_limit` variable is still true, then no more floors can be added"}],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18","ID":"prod-ghebuogpe0e","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"So give up and break the loop"}],"selectGeom":false},{"type":1,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18","ID":"prod-2x8ztj2jbjv","enabled":true,"print":false,"argCount":1,"args":[{"name":"condition","value":"reached_limit","usedVars":["reached_limit"],"jsValue":"reached_limit_"}],"children":[{"type":13,"ID":"prod-s0utnj185li","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~8","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":6,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~procedure~18~children~8","ID":"prod-1x6k2pqefh5","enabled":true,"print":false,"argCount":0,"args":[],"selectGeom":false}],"selectGeom":false}],"variable":["i"],"selectGeom":false},{"type":14,"ID":"prod-leuzdwyzjwo","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Save the Gross Plot Ratio for the whole block as an attribute"}],"selectGeom":false},{"type":0,"ID":"prod-uj2ve6z34i","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"coll@gpr","jsValue":"coll_@gpr","usedVars":["coll"]},{"name":"value","value":"(req_floor_area - rem_area) / coll@block_area","usedVars":["coll","req_floor_area","rem_area"],"jsValue":"(req_floor_area_ - rem_area_) /  __modules__.attrib.Get(__params__.model, coll_, 'block_area')"}],"variable":null,"selectGeom":false},{"type":14,"ID":"prod-rz7byplv7r","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Clean up"}],"selectGeom":false},{"type":8,"ID":"prod-bdaabr4c8wi","enabled":true,"print":false,"meta":{"module":"edit","name":"Delete"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"street_views","usedVars":["street_views"],"jsValue":"street_views_"},{"name":"method","value":"'delete_selected'","jsValue":"'delete_selected'","usedVars":[]}],"selectGeom":false}],"localFunc":[{"type":13,"ID":"local_func_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":16,"ID":"prod-dy0rs7okedc","enabled":true,"print":false,"argCount":5,"meta":{"module":"","name":"","otherInfo":{"prev_name":"createLayer","num_returns":3,"collapsed":false,"deletedArgs":[]}},"args":[{"name":"func_name","value":"createLayer","jsValue":"createLayer_"},{"name":"arg_1","value":"floors","jsValue":"floors_","usedVars":["floors"]},{"name":"arg_2","value":"dist","jsValue":"dist_","usedVars":["dist"]},{"name":"arg_3","value":"ang","jsValue":"ang_","usedVars":["ang"]},{"name":"arg_4","value":"rem_area","jsValue":"rem_area_","usedVars":["rem_area"]}],"children":[{"type":13,"ID":"prod-zfe6widc05p","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-lb25k0y12od","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Function creates one layer of the wedding cake massing"}]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-bsvqk3alus","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Function returns the total area of the new floors "}]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-4yh9xmks2jf","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"base","jsValue":"base_"},{"name":"value","value":"floors[-1]","usedVars":["floors"],"jsValue":"floors_[pythonList(-1, floors_.length)]"}],"variable":["base"]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-pkiy1qth31","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Inset base using local function"}]},{"type":18,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-184fd9u4nit","enabled":true,"print":false,"argCount":3,"meta":{"module":"localFunc","name":"insetFloor"},"args":[{"name":"var_name","value":"base_inset","jsValue":"base_inset_"},{"name":"pgon","value":"base","usedVars":["base"],"jsValue":"base_"},{"name":"dist","value":"dist","usedVars":["dist"],"jsValue":"dist_"}],"variable":["base_inset"]},{"type":1,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-hyytgq3m36","enabled":true,"print":false,"argCount":1,"args":[{"name":"condition","value":"base_inset == null","usedVars":["base_inset"],"jsValue":"base_inset_ == null"}],"children":[{"type":13,"ID":"prod-qkrtvkmvsij","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~6","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":17,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~6","ID":"prod-3ygi1i69iz4","enabled":true,"print":false,"argCount":1,"args":[{"name":"Value","value":"0","usedVars":[],"jsValue":"0"}],"selectGeom":false}],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-t3splqcic7b","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Calculate number of floors and height"}]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-38dfg4yjh0g","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"floor_height","jsValue":"floor_height_"},{"name":"value","value":"3","usedVars":[],"jsValue":"3"}],"variable":["floor_height"]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-zbcyyins10a","enabled":true,"print":false,"meta":{"module":"calc","name":"Area"},"argCount":3,"args":[{"name":"var_name","value":"floor_area","jsValue":"floor_area_"},{"name":"__model__"},{"name":"entities","value":"base_inset","usedVars":["base_inset"],"jsValue":"base_inset_"}],"variable":["floor_area"],"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-1x0wd9bhp0d","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"num_floors","jsValue":"num_floors_"},{"name":"value","usedVars":[],"value":"null","jsValue":"null"}],"variable":["num_floors"],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-uo8biouuve","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"\\x7e~~~~ START EDITING CODE ~~~~~"}]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-67cel3qkcdd","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"layer_height","jsValue":"layer_height_"},{"name":"value","usedVars":["dist","ang"],"value":"dist * tan(ang)","jsValue":"dist_ * tan(__debug__, ang_)"}],"selectGeom":false,"variable":["layer_height"]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-4g0htmpdr5d","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"ang_num_floors","jsValue":"ang_num_floors_"},{"name":"value","usedVars":["floor_height","layer_height"],"value":"floor(layer_height / floor_height)","jsValue":"floor(__debug__, layer_height_ / floor_height_)"}],"variable":["ang_num_floors"],"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-kh8dwa1bojq","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"gfar_num_floors","jsValue":"gfar_num_floors_"},{"name":"value","value":"floor(rem_area / floor_area)","usedVars":["floor_area","rem_area"],"jsValue":"floor(__debug__, rem_area_ / floor_area_)"}],"variable":["gfar_num_floors"],"selectGeom":false},{"type":1,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-djcazmzuwxc","enabled":true,"print":false,"argCount":1,"args":[{"name":"condition","value":"ang_num_floors < gfar_num_floors","usedVars":["ang_num_floors","gfar_num_floors"],"jsValue":"ang_num_floors_ < gfar_num_floors_"}],"children":[{"type":13,"ID":"prod-cihw2ylqhqw","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~15","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~15","ID":"prod-wvhyc9h2js","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"num_floors","jsValue":"num_floors_"},{"name":"value","usedVars":["ang_num_floors"],"value":"ang_num_floors","jsValue":"ang_num_floors_"}],"variable":["num_floors"],"selectGeom":false}],"selectGeom":false},{"type":3,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-pzjsvzdm87","enabled":true,"print":false,"argCount":0,"args":[],"children":[{"type":13,"ID":"prod-gr4b4x133kh","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~16","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~16","ID":"prod-nicdt44g94","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"num_floors","jsValue":"num_floors_"},{"name":"value","usedVars":["gfar_num_floors"],"value":"gfar_num_floors","jsValue":"gfar_num_floors_"}],"variable":["num_floors"],"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~16","ID":"prod-efl8t1ptuon","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"layer_height","jsValue":"layer_height_"},{"name":"value","usedVars":["num_floors","floor_height"],"value":"num_floors * floor_height","jsValue":"num_floors_ * floor_height_"}],"selectGeom":false,"variable":["layer_height"]}],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-44h4yf527ab","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"\\x7e~~~~ END EDITING CODE ~~~~~"}]},{"type":1,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-588eu5xm5gp","enabled":true,"print":false,"argCount":1,"args":[{"name":"condition","value":"num_floors == 0","usedVars":["num_floors"],"jsValue":"num_floors_ == 0"}],"children":[{"type":13,"ID":"prod-fik6tvcjhi8","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~18","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~18","ID":"prod-dh95px69dy8","enabled":true,"print":false,"meta":{"module":"edit","name":"Delete"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"base_inset","usedVars":["base_inset"],"jsValue":"base_inset_"},{"name":"method","value":"'delete_selected'","jsValue":"'delete_selected'","usedVars":[]}],"selectGeom":false},{"type":17,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1~children~18","ID":"prod-8sasunfx5zk","enabled":true,"print":false,"argCount":1,"args":[{"name":"Value","value":"0","usedVars":[],"jsValue":"0"}],"selectGeom":false}],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-v93tuopoat9","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Create floors using the extrude function, with \"copies\""}]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-3zlzdihfd1a","enabled":true,"print":false,"meta":{"module":"make","name":"Extrude"},"argCount":6,"args":[{"name":"var_name","value":"new_floors","jsValue":"new_floors_"},{"name":"__model__"},{"name":"entities","value":"base_inset","usedVars":["base_inset"],"jsValue":"base_inset_"},{"name":"dist","value":"layer_height - 0.1","usedVars":["layer_height"],"jsValue":"layer_height_ - 0.1"},{"name":"divisions","value":"num_floors","usedVars":["num_floors"],"jsValue":"num_floors_"},{"name":"method","value":"'copies'","jsValue":"'copies'","usedVars":[]}],"variable":["new_floors"],"selectGeom":false},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-flhjkeslev","enabled":true,"print":false,"meta":{"module":"list","name":"Add"},"argCount":4,"args":[{"name":"__none__"},{"name":"list","value":"floors","usedVars":["floors"],"jsValue":"floors_"},{"name":"item","value":"new_floors","usedVars":["new_floors"],"jsValue":"new_floors_"},{"name":"method","value":"'extend_end'","jsValue":"'extend_end'","usedVars":[]}]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-kycw8e32mpb","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Set attributes on new floors"}]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-yu8y3r3iez","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"new_floors@bldg_id","jsValue":"new_floors_@bldg_id","usedVars":["new_floors"]},{"name":"value","value":"base@bldg_id","usedVars":["base"],"jsValue":"__modules__.attrib.Get(__params__.model, base_, 'bldg_id')"}],"variable":null},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-0x89o1q43php","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"new_floors@area","jsValue":"new_floors_@area","usedVars":["new_floors"]},{"name":"value","value":"floor_area","usedVars":["floor_area"],"jsValue":"floor_area_"}],"variable":null,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-iqq26dt5yf","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"new_floors[:-1]@type","jsValue":"new_floors_.slice(0,-1)@type","usedVars":["new_floors"]},{"name":"value","value":"\"floor\"","usedVars":[],"jsValue":"\"floor\""}],"variable":null,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-h6qlv0d2twc","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"new_floors[-1]@type","jsValue":"new_floors_[pythonList(-1, new_floors_.length)]@type","usedVars":["new_floors"]},{"name":"value","value":"\"base\"","usedVars":[],"jsValue":"\"base\""}],"variable":null,"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-47coredqfh5","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Clean up"}]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-cypguy4j55i","enabled":true,"print":false,"meta":{"module":"edit","name":"Delete"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"base_inset","usedVars":["base_inset"],"jsValue":"base_inset_"},{"name":"method","value":"'delete_selected'","jsValue":"'delete_selected'","usedVars":[]}],"selectGeom":false},{"type":17,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~1","ID":"prod-c8fbrx4mfau","enabled":true,"print":false,"argCount":1,"args":[{"name":"Value","value":"num_floors * floor_area","usedVars":["floor_area","num_floors"],"jsValue":"num_floors_ * floor_area_"}],"selectGeom":false}],"variable":null,"selectGeom":false},{"type":16,"ID":"prod-g17i7n61mrc","enabled":true,"print":false,"argCount":3,"meta":{"module":"","name":"","otherInfo":{"prev_name":"insetFloor","num_returns":2,"collapsed":false}},"args":[{"name":"func_name","value":"insetFloor","jsValue":"insetFloor_"},{"name":"arg_1","value":"pgon","jsValue":"pgon_","usedVars":["pgon"]},{"name":"arg_2","value":"dist","jsValue":"dist_","usedVars":["dist"]}],"children":[{"type":13,"ID":"prod-g17i7n61mrc-blank","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-ean8no1hde","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Function insets a floor polygon using a poly2d function"}]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-az8loikq0pd","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Function returns the new inset polygon"}]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-wb23takakm","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Get the height of the polygon"}]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-j81w884leqp","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"z","jsValue":"z_"},{"name":"value","value":"(pgon#ps[0] @xyz )[2]","usedVars":["pgon"],"jsValue":"( __modules__.attrib.Get(__params__.model,  __modules__.query.Get(__params__.model, 'ps', pgon_)[pythonList(0, __modules__.query.Get(__params__.model, 'ps', pgon_).length)], 'xyz'))[pythonList(2, ( __modules__.attrib.Get(__params__.model,  __modules__.query.Get(__params__.model, 'ps', pgon_)[pythonList(0, __modules__.query.Get(__params__.model, 'ps', pgon_).length)], 'xyz')).length)]"}],"variable":["z"],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-mb2ijdfmtk","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"To create chamfered corners we inset, then offset (called a bounce)"}]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-g4az26jcipe","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"bounce","jsValue":"bounce_"},{"name":"value","value":"7","usedVars":[],"jsValue":"7"}],"variable":["bounce"]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-ih1tcw50i78","enabled":true,"print":false,"meta":{"module":"poly2d","name":"OffsetMitre"},"argCount":6,"args":[{"name":"var_name","value":"inset1","jsValue":"inset1_"},{"name":"__model__"},{"name":"entities","value":"pgon","usedVars":["pgon"],"jsValue":"pgon_"},{"name":"dist","value":"-(dist + bounce)","usedVars":["bounce","dist"],"jsValue":"-(dist_ + bounce_)"},{"name":"limit","value":"10","usedVars":[],"jsValue":"10"},{"name":"end_type","value":"'square_end'","jsValue":"'square_end'","usedVars":[]}],"variable":["inset1"],"selectGeom":false},{"type":1,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-w2qrcyrsw9","enabled":true,"print":false,"argCount":1,"args":[{"name":"condition","value":"len(inset1) == 0","usedVars":["inset1"],"jsValue":"len(__debug__, inset1_) == 0"}],"children":[{"type":13,"ID":"prod-w2qrcyrsw9-blank","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2~children~8","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":17,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2~children~8","ID":"prod-eiqz865cevb","enabled":true,"print":false,"argCount":1,"args":[{"name":"Value","value":"null","usedVars":[],"jsValue":"null"}],"selectGeom":false}]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-irg7m5yb02q","enabled":true,"print":false,"meta":{"module":"poly2d","name":"OffsetMitre"},"argCount":6,"args":[{"name":"var_name","value":"inset2","jsValue":"inset2_"},{"name":"__model__"},{"name":"entities","value":"inset1","usedVars":["inset1"],"jsValue":"inset1_"},{"name":"dist","value":"bounce","usedVars":["bounce"],"jsValue":"bounce_"},{"name":"limit","value":"10","usedVars":[],"jsValue":"10"},{"name":"end_type","value":"'square_end'","jsValue":"'square_end'","usedVars":[]}],"variable":["inset2"],"selectGeom":false},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-dm5srgilce","enabled":true,"print":false,"meta":{"module":"edit","name":"Delete"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"inset1","usedVars":["inset1"],"jsValue":"inset1_"},{"name":"method","value":"'delete_selected'","jsValue":"'delete_selected'","usedVars":[]}],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-44hyy182wjg","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"pol2d functions generate results on the XY plane"}]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-uq9zy3wt1e","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"So move the result back to the correct height"}]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-n5glcea2pm","enabled":true,"print":false,"meta":{"module":"modify","name":"Move"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"inset2","usedVars":["inset2"],"jsValue":"inset2_"},{"name":"vectors","value":"[0, 0, z + 0.1]","usedVars":["z"],"jsValue":"[0, 0, z_ + 0.1]"}],"selectGeom":false},{"type":17,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~localFunc~2","ID":"prod-v4i8o9630nn","enabled":true,"print":false,"argCount":1,"args":[{"name":"Value","value":"inset2[0]","usedVars":["inset2"],"jsValue":"inset2_[pythonList(0, inset2_.length)]"}]}],"variable":null}],"state":{"procedure":[],"show_code":true,"show_func":true,"hasExecuted":true},"input":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target","output":{"name":"output","type":1,"edges":[{"source":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output","target":{"name":"input","type":0,"edges":["~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0"],"meta":{"mode":0,"opts":{}},"parentNode":{"name":"Colors","id":"node_0hem32000s5t","position":{"x":5200,"y":5380},"enabled":true,"type":"","procedure":[{"type":13,"ID":"main_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":8,"ID":"prod-hepgm3gybxs","enabled":true,"print":false,"meta":{"module":"visualize","name":"Color"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"#pg ?@type==\"plot\"","usedVars":[],"jsValue":"__modules__.query.Filter(__params__.model,  __modules__.query.Get(__params__.model, 'pg', null), ['type', null], '==', \"plot\")"},{"name":"color","value":"[1, 0.8, 0.8]","usedVars":[],"jsValue":"[1, 0.8, 0.8]"}]},{"type":8,"ID":"prod-r4my40ru44","enabled":true,"print":false,"meta":{"module":"visualize","name":"Color"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"#pg ?@type==\"base\"","usedVars":[],"jsValue":"__modules__.query.Filter(__params__.model,  __modules__.query.Get(__params__.model, 'pg', null), ['type', null], '==', \"base\")"},{"name":"color","value":"[0.8, 1, 0.8]","usedVars":[],"jsValue":"[0.8, 1, 0.8]"}],"selectGeom":false}],"localFunc":[{"type":13,"ID":"local_func_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false}],"state":{"procedure":[],"show_code":true,"show_func":true,"hasExecuted":true},"input":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target","output":{"name":"output","type":1,"edges":[{"source":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output","target":{"name":"input","type":0,"edges":[{"source":{"name":"output","type":1,"edges":["~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0"],"meta":{"mode":0},"parentNode":{"name":"Views","id":"node_o3arpp5cci","position":{"x":5480,"y":5380},"enabled":true,"type":"","procedure":[{"type":13,"ID":"main_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":14,"ID":"prod-raxcnnfxo4c","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"If the script parameter is not 'show', then dont execute this node"}]},{"type":1,"ID":"prod-uv03it0jk2e","enabled":true,"print":false,"argCount":1,"args":[{"name":"condition","value":"SHOW_VIEW != \"show\"","usedVars":["SHOW_VIEW"],"jsValue":"SHOW_VIEW_ != \"show\""}],"children":[{"type":13,"ID":"prod-uv03it0jk2e-blank","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~2","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":17,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~2","ID":"prod-e94tuk3ia14","enabled":true,"print":false,"argCount":0,"args":[]}]},{"type":14,"ID":"prod-32ny0w3e7ba","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Calc the view angle in radians"}]},{"type":0,"ID":"prod-wmcr8e56t2d","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"ang","jsValue":"ang_"},{"name":"value","value":"-degToRad(VIEW_ANGLE / 2)","usedVars":["VIEW_ANGLE"],"jsValue":"-degToRad(__debug__, VIEW_ANGLE_ / 2)"}],"variable":["ang"],"selectGeom":false},{"type":14,"ID":"prod-kl5cf0u0q6","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Get some data"}]},{"type":0,"ID":"prod-lukev89881d","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"view_pgons","jsValue":"view_pgons_"},{"name":"value","value":"[]","usedVars":[],"jsValue":"[]"}],"variable":["view_pgons"]},{"type":0,"ID":"prod-9lwn2fzx66h","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"plots","jsValue":"plots_"},{"name":"value","value":"#pg ?@type==\"plot\"","usedVars":[],"jsValue":"__modules__.query.Filter(__params__.model,  __modules__.query.Get(__params__.model, 'pg', null), ['type', null], '==', \"plot\")"}],"variable":["plots"]},{"type":14,"ID":"prod-872inyypaal","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Loop through all the plots"}]},{"type":4,"ID":"prod-8oks6jj4ic","enabled":true,"print":false,"argCount":2,"args":[{"name":"item","value":"plot","jsValue":"plot_"},{"name":"list","value":"plots","usedVars":["plots"],"jsValue":"plots_"}],"children":[{"type":13,"ID":"prod-8oks6jj4ic-blank","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-d0mng5fbwfm","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Get all the polygons for this plot (they all have the same 'bldg_id')"}]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-ptr479n1k8c","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"floors","jsValue":"floors_"},{"name":"value","value":"#pg ?@bldg_id==plot@bldg_id","usedVars":["plot"],"jsValue":"__modules__.query.Filter(__params__.model,  __modules__.query.Get(__params__.model, 'pg', null), ['bldg_id', null], '==',  __modules__.attrib.Get(__params__.model, plot_, 'bldg_id'))"}],"variable":["floors"]},{"type":1,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-5fp2l8umq22","enabled":true,"print":false,"argCount":1,"args":[{"name":"condition","usedVars":["floors"],"value":"len(floors) == 3","jsValue":"len(__debug__, floors_) == 3"}],"children":[{"type":13,"ID":"prod-5vhprg4wo34","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~3","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":7,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~3","ID":"prod-kc78lqoj51k","enabled":true,"print":false,"argCount":0,"args":[]}],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-0q0tyc96mt5q","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Get the height of the top polygon"}]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-czzh9s3fktk","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"top_floor","jsValue":"top_floor_"},{"name":"value","value":"floors[-1]","usedVars":["floors"],"jsValue":"floors_[pythonList(-1, floors_.length)]"}],"variable":["top_floor"]},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-jtkzxsk47ef","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"z","jsValue":"z_"},{"name":"value","value":"top_floor#ps[0] @xyz[2]","usedVars":["top_floor"],"jsValue":"__modules__.attrib.Get(__params__.model,  __modules__.query.Get(__params__.model, 'ps', top_floor_)[pythonList(0, __modules__.query.Get(__params__.model, 'ps', top_floor_).length)], ['xyz', 2])"}],"variable":["z"]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-se1wwjlmed","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Create the street centreline"}]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-8gmyo9ybue5","enabled":true,"print":false,"meta":{"module":"poly2d","name":"OffsetMitre"},"argCount":6,"args":[{"name":"var_name","value":"street_view","jsValue":"street_view_"},{"name":"__model__"},{"name":"entities","value":"plot","usedVars":["plot"],"jsValue":"plot_"},{"name":"dist","value":"STREET_WIDTH / 2","usedVars":["STREET_WIDTH"],"jsValue":"STREET_WIDTH_ / 2"},{"name":"limit","value":"10","usedVars":[],"jsValue":"10"},{"name":"end_type","value":"'square_end'","jsValue":"'square_end'","usedVars":[]}],"variable":["street_view"],"selectGeom":false},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-o1rarbti1io","enabled":true,"print":false,"meta":{"module":"make","name":"Polyline"},"argCount":4,"args":[{"name":"var_name","value":"street_cline","jsValue":"street_cline_"},{"name":"__model__"},{"name":"entities","value":"street_view","usedVars":["street_view"],"jsValue":"street_view_"},{"name":"close","value":"'close'","jsValue":"'close'","usedVars":[]}],"variable":["street_cline"]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-zixkj1pwkzk","enabled":true,"print":false,"meta":{"module":"edit","name":"Delete"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"street_view","usedVars":["street_view"],"jsValue":"street_view_"},{"name":"method","value":"'delete_selected'","jsValue":"'delete_selected'","usedVars":[]}],"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9","ID":"prod-hyyxgbgrhvh","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Loop through the edges of the street centreline"}]},{"type":4,"ID":"prod-ff6nydzf72o","enabled":true,"print":false,"argCount":2,"args":[{"name":"item","value":"edge","jsValue":"edge_"},{"name":"list","value":"street_cline#_e","usedVars":["street_cline"],"jsValue":"__modules__.query.Get(__params__.model, '_e', street_cline_)"}],"children":[{"type":13,"ID":"prod-09r6cw35p20t","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-u4bwm900n1","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Create a ray for rotation"}]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-mzd2q76ak4","enabled":true,"print":false,"meta":{"module":"calc","name":"Ray"},"argCount":3,"args":[{"name":"var_name","value":"ray","jsValue":"ray_"},{"name":"__model__"},{"name":"entities","value":"edge","usedVars":["edge"],"jsValue":"edge_"}],"variable":["ray"]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-95319tjytpe","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Create a polyline for extruding"}]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-s8sfcmneiks","enabled":true,"print":false,"meta":{"module":"make","name":"Polyline"},"argCount":4,"args":[{"name":"var_name","value":"pline","jsValue":"pline_"},{"name":"__model__"},{"name":"entities","value":"edge","usedVars":["edge"],"jsValue":"edge_"},{"name":"close","value":"'open'","jsValue":"'open'","usedVars":[]}],"variable":["pline"]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-vj4gef5xv3","enabled":true,"print":false,"meta":{"module":"edit","name":"Weld"},"argCount":4,"args":[{"name":"var_name","value":"posis","jsValue":"posis_"},{"name":"__model__"},{"name":"entities","value":"pline","usedVars":["pline"],"jsValue":"pline_"},{"name":"method","value":"'break_weld'","jsValue":"'break_weld'","usedVars":[]}],"variable":["posis"]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-p7470rto7zd","enabled":true,"print":false,"meta":{"module":"calc","name":"Centroid"},"argCount":4,"args":[{"name":"var_name","value":"cen","jsValue":"cen_"},{"name":"__model__"},{"name":"entities","value":"edge","usedVars":["edge"],"jsValue":"edge_"},{"name":"method","value":"'ps_average'","usedVars":[],"jsValue":"'ps_average'"}],"variable":["cen"]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-04j35vnorx8b","enabled":true,"print":false,"meta":{"module":"modify","name":"Scale"},"argCount":5,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"pline","usedVars":["pline"],"jsValue":"pline_"},{"name":"plane","value":"cen","usedVars":["cen"],"jsValue":"cen_"},{"name":"scale","value":"0.1","usedVars":[],"jsValue":"0.1"}]},{"type":14,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-403g7qw96rm","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Extrude upwards and then rotate by the view angle"}]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-4pyzn69rszs","enabled":true,"print":false,"meta":{"module":"make","name":"Extrude"},"argCount":6,"args":[{"name":"var_name","value":"view_pgon","jsValue":"view_pgon_"},{"name":"__model__"},{"name":"entities","value":"pline","usedVars":["pline"],"jsValue":"pline_"},{"name":"dist","value":"z + 10","usedVars":["z"],"jsValue":"z_ + 10"},{"name":"divisions","value":"1","usedVars":[],"jsValue":"1"},{"name":"method","value":"'quads'","jsValue":"'quads'","usedVars":[]}],"variable":["view_pgon"]},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-ot9mqcmtte","enabled":true,"print":false,"meta":{"module":"modify","name":"Rotate"},"argCount":5,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"view_pgon","usedVars":["view_pgon"],"jsValue":"view_pgon_"},{"name":"ray","value":"ray","usedVars":["ray"],"jsValue":"ray_"},{"name":"angle","value":"ang","usedVars":["ang"],"jsValue":"ang_"}],"selectGeom":false},{"type":8,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9~children~12","ID":"prod-z4h10nxhlg","enabled":true,"print":false,"meta":{"module":"list","name":"Add"},"argCount":4,"args":[{"name":"__none__"},{"name":"list","value":"view_pgons","usedVars":["view_pgons"],"jsValue":"view_pgons_"},{"name":"item","value":"view_pgon","usedVars":["view_pgon"],"jsValue":"view_pgon_"},{"name":"method","value":"'to_end'","jsValue":"'to_end'","usedVars":[]}]}],"variable":["edge"],"selectGeom":false,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~procedure~9"}],"variable":["plot"]},{"type":14,"ID":"prod-wu7i6gvwwof","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"Add a glass material"}]},{"type":8,"ID":"prod-wk9g4gauhks","enabled":true,"print":false,"meta":{"module":"material","name":"Glass"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"name","value":"\"glass\"","usedVars":[],"jsValue":"\"glass\""},{"name":"opacity","value":"0.5","usedVars":[],"jsValue":"0.5"}]},{"type":8,"ID":"prod-51504vemq3b","enabled":true,"print":false,"meta":{"module":"material","name":"Set"},"argCount":4,"args":[{"name":"__none__"},{"name":"__model__"},{"name":"entities","value":"view_pgons","usedVars":["view_pgons"],"jsValue":"view_pgons_"},{"name":"material","value":"\"glass\"","usedVars":[],"jsValue":"\"glass\""}]}],"localFunc":[{"type":13,"ID":"local_func_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false}],"state":{"procedure":[],"show_code":true,"show_func":true,"hasExecuted":true},"input":{"name":"input","type":0,"edges":[{"source":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output","target":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~input","selected":false}],"meta":{"mode":0,"opts":{}},"parentNode":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode"},"output":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source","hasError":false,"model":6}},"target":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target","selected":false},{"source":{"name":"output","type":1,"edges":["~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1"],"meta":{"mode":0},"parentNode":{"name":"HUD","id":"node_g3qnldn6xo","position":{"x":5340,"y":5380},"enabled":true,"type":"","procedure":[{"type":13,"ID":"main_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":14,"ID":"prod-ockvee2kv19","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"In the scrip parameters, the target plot ratio can be set."}]},{"type":14,"ID":"prod-m1iv8xsa4ip","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"However it may be impossible to reach that plot ratio."}]},{"type":14,"ID":"prod-tk84l4m4pz","enabled":true,"print":false,"argCount":1,"args":[{"name":"comment","value":"So we display the actual plot ratio achieved in the Heads Up Display"}]},{"type":0,"ID":"prod-99meqclvnx","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"text","jsValue":"text_"},{"name":"value","value":"\"\"","usedVars":[],"jsValue":"\"\""}],"variable":["text"]},{"type":4,"ID":"prod-0x5ag7vibzrk","enabled":true,"print":false,"argCount":2,"args":[{"name":"item","value":"coll","jsValue":"coll_"},{"name":"list","value":"#co","usedVars":[],"jsValue":"__modules__.query.Get(__params__.model, 'co', null)"}],"children":[{"type":13,"ID":"prod-0x5ag7vibzrk-blank","parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1~source~parentNode~procedure~5","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":0,"parent":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1~source~parentNode~procedure~5","ID":"prod-1vrc3q936ij","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"text","jsValue":"text_"},{"name":"value","value":"text + \"Gross Plot Ratio: \" + numToStr(coll@gpr , 1) + \"\\n\"","usedVars":["text","coll"],"jsValue":"text_ + \"Gross Plot Ratio: \" + numToStr(__debug__,  __modules__.attrib.Get(__params__.model, coll_, 'gpr'), 1) + \"\\n\""}],"variable":["text"]}],"variable":["coll"]},{"type":0,"ID":"prod-rwc4pw4zy6c","enabled":true,"print":false,"argCount":2,"args":[{"name":"var_name","value":"@hud","jsValue":"@hud","usedVars":[]},{"name":"value","value":"text","usedVars":["text"],"jsValue":"text_"}],"variable":null}],"localFunc":[{"type":13,"ID":"local_func_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false}],"state":{"procedure":[],"show_code":true,"show_func":true,"hasExecuted":true},"input":{"name":"input","type":0,"edges":[{"source":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output","target":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1~source~parentNode~input","selected":false}],"meta":{"mode":0,"opts":{}},"parentNode":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1~source~parentNode"},"output":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1~source","hasError":false,"model":7}},"target":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target","selected":false},"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0"],"meta":{"mode":0,"opts":{}},"parentNode":{"name":"End","id":"node_99yla1hwt69","position":{"x":5320,"y":5480},"enabled":true,"type":"end","procedure":[{"type":13,"ID":"main_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false},{"type":11,"ID":"Return","meta":{"name":"","module":""},"argCount":2,"args":[{"name":"__model__","value":"","jsValue":""},{"name":"value","value":"","jsValue":"","usedVars":[]}],"print":false,"enabled":true,"terminate":false}],"localFunc":[{"type":13,"ID":"local_func_blank","meta":{"name":"","module":""},"argCount":0,"args":[],"print":false,"enabled":true,"selectGeom":false}],"state":{"procedure":[],"show_code":true,"show_func":true,"hasExecuted":true},"input":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target","output":{"name":"output","type":1,"edges":[],"meta":{"mode":0},"parentNode":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode"},"hasError":false,"model":8}},"selected":false}],"meta":{"mode":0},"parentNode":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode"},"hasError":false,"model":5}},"selected":false},"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~input~edges~0","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1~source~parentNode~input~edges~0"],"meta":{"mode":0},"parentNode":"~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode"},"hasError":false,"model":4}},"selected":false}],"meta":{"mode":0},"parentNode":"~flowchart~nodes~0~output~edges~0~target~parentNode"},"model":3}},"selected":false}],"meta":{"mode":0},"parentNode":"~flowchart~nodes~0"},"hasError":false,"model":2},"~flowchart~nodes~0~output~edges~0~target~parentNode","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1~source~parentNode","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode"],"edges":["~flowchart~nodes~0~output~edges~0","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~0~source~parentNode~input~edges~0","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~edges~1~source~parentNode~input~edges~0","~flowchart~nodes~0~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0~target~parentNode~output~edges~0"],"functions":[],"ordered":true,"last_updated":"2021-10-21T03:21:07.633Z"},"version":"0.8.10","settings":"{\"normals\":{\"show\":false,\"size\":5},\"axes\":{\"show\":true,\"size\":50},\"grid\":{\"show\":true,\"size\":500,\"pos_x\":0,\"pos_y\":0,\"pos_z\":0,\"pos\":{\"x\":0,\"y\":0,\"z\":0}},\"positions\":{\"show\":false,\"size\":5.7},\"tjs_summary\":{\"show\":false},\"gi_summary\":{\"show\":false},\"wireframe\":{\"show\":false},\"camera\":{\"pos\":{\"x\":-184.6659780354571,\"y\":-573.7633726504096,\"z\":271.83591476833425},\"target\":{\"x\":0,\"y\":0,\"z\":0},\"ortho\":false,\"pos_x\":53.5814374439155,\"pos_y\":-185.37821573725412,\"pos_z\":157.25085572726252},\"colors\":{\"viewer_bg\":\"#E6E6E6\",\"position\":\"#000000\",\"position_s\":\"#0033FF\",\"vertex_s\":\"#FFCC00\",\"face_f\":\"#FFFFFF\",\"face_f_s\":\"#4949BD\",\"face_b\":\"#DDDDDD\",\"face_b_s\":\"#00006D\"},\"ambient_light\":{\"show\":true,\"color\":\"#FFFFFF\",\"intensity\":0.5},\"hemisphere_light\":{\"show\":true,\"helper\":false,\"skyColor\":\"#FFFFFF\",\"groundColor\":\"#FFFFFF\",\"intensity\":0.5},\"directional_light\":{\"show\":false,\"helper\":false,\"color\":\"#FFFFFF\",\"intensity\":1,\"shadow\":true,\"shadowSize\":4,\"azimuth\":90,\"altitude\":45,\"distance\":10000,\"type\":\"directional\"},\"ground\":{\"show\":false,\"width\":1000,\"length\":1000,\"height\":-0.5,\"color\":\"#FFFFFF\",\"shininess\":0},\"select\":{\"selector\":{\"id\":7,\"name\":\"Polygons\"},\"tab\":\"0\",\"enabledselector\":{\"ps\":true,\"_v\":true,\"_e\":true,\"_w\":true,\"_f\":true,\"pt\":true,\"pl\":true,\"pg\":true,\"co\":true}},\"version\":\"0.4.38\",\"background\":{\"show\":true,\"background_set\":0},\"cesium\":{\"imagery\":{\"layer\":\"Open Street Map\",\"terrain\":\"Ellipsoid\",\"apiKey\":{\"here\":\"7vMRjLNCpcOAUQXU61eUp6EFbWCy7WLNmy9qLHO-1Bw\"}},\"camera\":{\"pos\":{\"x\":0,\"y\":0,\"z\":0},\"direction\":{\"x\":0,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":0,\"z\":0},\"right\":{\"x\":0,\"y\":0,\"z\":0}},\"updated\":true,\"time\":{\"date\":\"2020-05-11\"},\"model\":{\"polygonEdge\":true}},\"aframe\":{\"camera\":{\"position\":{\"x\":0,\"y\":5,\"z\":0},\"rotation\":{\"x\":0,\"y\":0,\"z\":0},\"acceleration\":444,\"show_cam_info\":true},\"background\":{\"background_set\":1,\"background_url\":\"\",\"background_position\":{\"x\":0,\"y\":0,\"z\":0},\"background_rotation\":0},\"ambient_light\":{\"show\":true,\"color\":\"#FFFFFF\",\"intensity\":0.15},\"hemisphere_light\":{\"show\":true,\"skyColor\":\"#FFFFFF\",\"groundColor\":\"#FFFFFF\",\"intensity\":0.15,\"helper\":false},\"directional_light\":{\"show\":true,\"color\":\"#FFFFFF\",\"intensity\":1,\"azimuth\":90,\"altitude\":45,\"shadowSize\":2048,\"helper\":false,\"shadow\":true,\"distance\":10,\"type\":\"directional\"},\"ground\":{\"show\":false,\"width\":1000,\"length\":1000,\"height\":-0.5,\"color\":\"#FFFFFF\",\"shininess\":0},\"updated\":true,\"vr_hotspot\":{\"background_url\":\"\",\"background_rotation\":0,\"foreground_url\":\"\",\"foreground_rotation\":0},\"vr\":{\"background_url\":\"\",\"background_rotation\":0,\"foreground_url\":\"\",\"foreground_rotation\":0}},\"day_light\":{\"show\":true,\"helper\":false,\"intensity\":1,\"position\":[0,2000,1000],\"size\":1000},\"geo\":{\"imagery\":{\"layer\":\"Open Street Map\",\"terrain\":\"Ellipsoid\",\"apiKey\":{\"here\":\"7vMRjLNCpcOAUQXU61eUp6EFbWCy7WLNmy9qLHO-1Bw\"}},\"camera\":{\"pos\":{\"x\":-1527170.4564504684,\"y\":6191377.229851589,\"z\":142492.86697965642},\"direction\":{\"x\":0,\"y\":0,\"z\":0},\"up\":{\"x\":0,\"y\":0,\"z\":0},\"right\":{\"x\":0,\"y\":0,\"z\":0},\"rot\":{\"x\":-2.8946890807177175,\"y\":0.03332128705035884,\"z\":2.8868931928931136}},\"time\":{\"date\":\"2021-01-27T16:00\"},\"model\":{\"polygonEdge\":false},\"updated\":true}}"}